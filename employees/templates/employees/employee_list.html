{% extends "employees/employees.html" %}
{% load common_tags search_tags thumbnail %}

{% block title %}All Employees{% endblock %}

{% block breadcrumbs %}All employees{% endblock %}

{% block content %}
{% if user.is_superuser %}
{% menu "e-export-menu" "Download List" "right" %}
    <li><a href="{% url 'employees_export_employees' %}?groupby=unit">Group by Unit</a></li>
    <li><a href="{% url 'employees_export_employees' %}?groupby=location">Group by Location</a></li>
{% endmenu %}
{% endif %}
<h2>All Employees</h2>
<table class="show-current-row employee-list jquery-thead">
    <thead>
        <tr>
            <th scope="col" style="width: 6%">&nbsp;</th>
            <th scope="col" style="width: 18%">Name</th>
            <th scope="col" style="width: 10%">&nbsp;</th>
            <th scope="col" style="width: 10%">Staff ID</th>
            <th scope="col" style="width: 14%">Birth Date</th>
            <th scope="col" style="width: 16%">Position</th>
            <th scope="col" style="width: 16%">Unit</th>
            <th scope="col" style="width: 8%">Status</th>
            <th scope="col" style="width: 2%">&nbsp;</th>
        </tr>
    </thead>
    <tbody>
        {% for employee in employee_list %}
        <tr class="{% cycle 'odd' 'even' %}{% ifchanged employee.first_name|first %} section-group{% endifchanged %}">
            <td class="section-group-name">
                {% ifchanged %}{{ employee.first_name|first|upper }}{% endifchanged %}
            </td>
            <td>{{ employee.full_name }}</td>
            <td class="photo">
                <img src="{% if employee.photo %}{% thumbnail employee.photo 80x80 autocrop crop %}{% else %}{{ STATIC_URL }}images/aang.png{% endif %}" alt="" />
            </td>
            <td>{{ employee.staff_id_number }}</td>
            <td>
                {% if is_own_profile or perms.can_manage_employees %}{{ employee.birth_date|date:"jS F, Y" }}{% else %}{{ employee.birth_date|date:"jS F" }}{% endif %}
            </td>
            <td>{{ employee.position }}</td>
            <td>{{ employee.unit }}</td>
            <td>{{ employee.get_status_display }}</td>
            <td>
                {% if user.is_superuser %}
                {% with employee.first_name|capfirst as name %}
                {% contextmenu "e-actions" %}
                    <li><a href="{% url 'employees_employee_profile' employee_id=employee.pk %}">View profile</a></li>
                    <li><a href="{% url 'employees_payinfo' employee_id=employee.pk %}">View pay information</a></li>
                    <li class="dropdown-divider"></li>
                    <li><a href="{% url 'appraisals_schedule_appraisal' employee_id=employee.pk %}">Schedule appraisal</a></li>
                    <li><a href="{% url 'appraisals_complete_appraisal' employee_id=employee.pk %}">Perform appraisal</a></li>
                    <li><a href="{% url 'employees_appraisal_history' employee_id=employee.pk %}">View appraisal history</a></li>
                    <li class="dropdown-divider"></li>
                    <li><a href="{% url 'employees_move_employee' employee_id=employee.pk %}">Transfer {{ name }}</a></li>
                {% endcontextmenu %}
                {% endwith %}
                {% else %}
                <a href="{% url 'employees_employee_profile' employee_id=employee.pk %}" title="View {{ employee.full_name }}'s profile">view</a>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="9">
                There aren't any employees in the database yet.
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% paginate %}
{% endblock %}
