{% extends "employees/employees.html" %}
{% load payroll_tags %}

{% block title %}
{% ifequal employee.user user %}My Payslips{% else %}{{ employee.full_name }}'s Payslips{% endifequal %}
{% endblock %}

{% block breadcrumbs %}
<a href="{% url 'employees_list' %}">All employees</a> &raquo;
<a href="{{ employee.get_absolute_url }}">{{ employee.full_name }}</a> &raquo; Payslips
{% endblock %}

{% block content %}
<h2>
{% ifequal employee.user user %}My Payslips{% else %}{{ employee.full_name }}'s Payslips{% endifequal %}
</h2>
<table class="drop-shadow show-current-row" style="width: 60%">
	<thead>
		<tr>
			<th>Period</th>
			<th>Type</th>
            <th>&nbsp;</th>
		</tr>
	</thead>
	<tbody>
		{% for payslip in payslip_list %}
            {% with payslip.batch as batch %}
            <tr class="{% cycle 'odd' 'even' %}">
                <td>Batch #{{ batch.id }} ({% display_period batch.process_from batch.process_to %})</td>
                <td>{{ batch.pay_types.all|join:", " }}</td>
                <td>
                    <a href="#" data-dropdown="#p-payslip-actions-{{ batch.pk }}">actions</a>
                    <div id="p-payslip-actions-{{ batch.pk }}" class="dropdown">
                        <ul class="dropdown-menu">
                            <li><a href='{% url "employees_payslip_details" employee_id=employee.pk id=payslip.pk %}'>View payslip</a></li>
                            <li><a href="{% url 'employees_payslip_pdf' employee_id=employee.pk id=payslip.pk %}">Download payslip (PDF)</a></li>
                        </ul>
                    </div>
                </td>
            </tr>
            {% endwith %}
		{% empty %}
		<tr>
			<td colspan="2">
				{% ifequal employee.user user %}You don't{% else %}{{ employee.user.first_name }} doesn't{% endifequal %} have any payslips. Yet.
			</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
{% endblock %}
